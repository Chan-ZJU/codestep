# 第五章：输入输出系统

## 5.1 概述

### 输入输出系统的发展概况

1. 早期

分散连接
CPU 和 IO 设备串行工作，程序查询方式。

2. 接口模块和 DMA 阶段

总线连接
CPU 和 IO 设备并行工作，中断方式，DMA方式

3. 具有通道结构的阶段

4. 具有 I/O 处理机的阶段

微处理器或直接用主机的处理器来执行。

### 输入输出系统的组成

1. I/O 软件

* I/O 指令，CPU 指令的一部分。操作码，命令码，设备码。

* 通道指令，通道自身的指令。指出数组的首地址，传送字数，操作命令。

2. I/O 硬件

设备，I/O 接口

设备，设备控制器  通道。

### I/O 设备于主机的联系方式

1. I/O 设备的编址方式。

* 统一编址：直接采用 CPU 的取数，存数指令即可。
* 不统一编址：单独编址，针对 I/O 设备单独编写一套指令。

2. 设备选址

用设备选择电路识别是否被选中。选中后传输数据。

3. 传送方式

* 串行：数据逐个传送。
* 并行：多条数据同时传送。

4. 联络方式

* 立即响应
* 异步工作应答信号
* 同步工作的方式    

5. I/O 设备与主机的连接方式

* 辐射式连接，每台设备都配一套控制线路的信号线。早期设备少可以这样搞，但是后期设备多了。导致可移植性差，并且不利于增删设备可扩展性差。
* 总线连接，外部设备的数据存放到缓存中。


### 5.1.4 I/O 设备与主机信息传送的控制方式

1. 程序查询方式

CPU 时时刻刻的”盯着“ I/O 设备 ，
一旦 I/O 设备状态发生改变，
CPU 就从 I/O 接口中读取一个字。然后 CPU 再将这个字写入内存中。
然后继续盯着 I/O 设置。不断循环。

在这个过程中 CPU 一直被 I/O 设备所占用，没有执行其他任务。

**信息交换**必须通过 CPU 来完成。

2. 程序中断方式

CPU 一直等着 I/O 状态改变，一直被占用显然不合理。对此进行了改进。

将 I/O 设备分为**自身准备阶段**和**与主机交换信息阶段**。

CPU 处于自身准备阶段时 CPU 不会执行查询，当外部设备收到数据后，会向 CPU 提出中断请求，让 CPU 停止当前程序的执行。

CPU 将当前执行到一半的程序停下，开始和 I/O 设备交换信息，将信息写入内存中。

这种方式将 CPU 解放了出来，不需要一直盯着 I/O 设备状态的变化，实现了二者的并行。
但是缺点是数据依旧需要通过 CPU 进入内存，CPU 解放的不彻底。CPU 切换信息时需要保存现场，进行中断，执行完毕后再恢复现场。

3. DMA 方式

内存和 I/O 之间建立了一条通道。

外部设备可以直接通内存进行交换数据，不需要再经过 CPU 。

## 5.2 IO 设备

种类很多。

### 概述

外部设备大致分为三类：
1. 人机交互设备：键盘，鼠标，打印机，显示器。
2. 计算机信息存储设备：磁盘，光盘，磁带。
3. 机 - 机通信设备： 调制解调器。

### 输入设备

1. 键盘
2. 鼠标
3. 触摸屏

### 输出设备

1. 显示器
   1. 字符显示
   2. 图形显示
   3. 图像显示
2. 打印机
   1. 击打式。
   2. 非击打式。
### 其他

1. A/D,D/A 模拟/数字 转换器
2. 中断
3. 汉字处理

### 多媒体技术

1. 什么是多媒体技术
例如语音识别。
2. 涉及到的技术。
数据压缩，编码，语音识别。

## 5.3 I/O 接口

### 概述

硬软件接口。主机与 I/O 设备之间的接口。

为什么要设置接口？
1. 明确对应设备。
2. 数据缓冲达到速度匹配。
3. 实现数据串-并格式转换。
4. 实现电平转换。
5. 传送控制命令。
6. 反应设备的状态。

### 接口的功能和组成

1. 通过总线来连接 I/O 接口电路。
   1. 设备选择线。
   2. 数据线
   3. 命令线
   4. 状态线

2. 接口的功能和组成

* 功能：选址，传送命令，传送数据，反应设备状态。
* 组成：设备选择电路，命令寄存器，命令译码器，数据缓存寄存器，设备状态标记。

触发器：完成触发器，工作触发器，中断请求触发器，屏蔽触发器。

3. I/O 接口的基本组成

### 接口的类型

1. 按照数据传送方式 并行还是串行。
2. 按功能选择的灵活性方式：可编程还是不可编程。
3. 按通用性：通用接口和专用接口。
4. 数据传送的控制方式：中断接口，DMA 接口。

## 5.4 程序查询方式

### 程序查询方式的流程

设备的查询顺序就是优先级。

计数器，正数负数，表示数据长度。用于判读数据是否发送完毕。

### 程序查询方式的接口电路

一张图..待补。

## 5.5 程序中断方式

### 中断概念

CPU 在执行程序时发生意外，保存当前程序的状态，停止当前程序去执行其他程序。执行完毕后再回头执行之前的程序。

### 中断的产生

中断源：导致中断的方式。

### 中断方式的接口电路

1. 配置中断请求触发器和中断屏蔽触发器。
2. 排队器。
3. 中断向量地址形成部件。
4. 程序中断方式接口电路的基本组成。

## 5.6 DMA方式
