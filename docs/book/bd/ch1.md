# 数据仓库

## 架构

大数据部门的组织架构：

![](https://gitee.com/weijiew/pic/raw/master/img/20201128232049.png)

项目组成：

![](https://gitee.com/weijiew/pic/raw/master/img/20201128232250.png)


# 磁盘

RAID：即廉价冗余磁盘阵列，作用是将大量数据分散在多个廉价的小磁盘之上，实现了不需要通过廉价小容量的磁盘来存储大量的数据。

RAID 的进化过程分为多代。

1. RAID0 第零代没有任何**冗余策略**，数据仅仅是分散在了多个磁盘之上。
   1. 优点是低成本，高读写性能，空间 100% 利用等优点。
   2. 缺点是数据一旦损坏就无法恢复。
2. RAID1 第一代提供了数据容错的功能，也就是将数据备份存在不同的磁盘之上，顺序读取，空间利用率是 50% 。
   1. 优点是具备完全容错能力，
   2. 缺点是实现成本高。
3. RAID2 第二代引入了海明码，用于校验数据，在原始数据上加入了校验码来进行**错误检测**和**纠正**。
   1. 优点是保证了数据的安全性，数据传输性能很高。
   2. 缺点是数据冗余开销大，数据重建非常耗时，实际中很少应用，主流商业产品均不支持。
4. 第三代引入了**校验盘**，也就是将校验信息单独存储在一个磁盘中，校验盘可以有多个。其余数据单独存储在数据盘中。**经典的一代**。
   1. 优点是 RAID3 在完好时读性能与 RAID0 完全一致，并且提供了数据纠错能力。
   2. 缺点是 RAID3 只需要一个校验盘，阵列的存储空间利用率高。
5. 第四代将校验盘定成了一个，所有的校验信息都存放在其中。
   1. 优点是**读性能**很高。
   2. 缺点也恰恰是因为一个校验盘，成为了系统性能的瓶颈。
6. 第五代是将校验数据分散在了阵列中的所有磁盘上，没有采用专门的校验磁盘。可以认为是 RAID0 和 RAID1 的折中。
   1. 优点是避免了一个校验盘性能瓶颈的问题。
   2. 缺点是重建数据时 RAID5 的性能受影响大。


## 概念

数据仓库：为决策提供数据支撑。实现了数据的备份，清洗，聚合，统计功能，为数据的最终目的做好准备。

* 业务数据：登陆，支付，下单等数据信息，一般存储在 Mysql，Oracle 中。采用 Sqoop 来存入数据仓库中。
* 用户行为数据：与客户端交互的数据。例如：浏览，收藏等操作。某种程度上可以体现用户的心理。日志，文件格式存储。采用 Flume 来存入数据仓库中。
* 爬虫数据：容易产生法律问题！

![](https://gitee.com/weijiew/pic/raw/master/img/20201128233233.png)

# 需求分析

## 项目需求

1. 行为数据采集平台搭建。
2. 业务数据采集平台搭建。
3. 数据仓库维度建模。
4. 指标统计，例如：用户，流量，销售等指标。
5. 即席查询工具，随时都能分析指标。
6. 集群性能监控，发生异常时可以报警。
7. 元数据监控，用于判定哪个任务出现问题，修正。
8. 质量监控，监控数据是否超过合理范围等一些数据问题，实现数据监控。

## 技术选型

1. 数据量大小：
   1. 小：myslq 。
   2. 大：Hadoop 的 HDFS 中。
2. 业务需要求：
   1. 业务数据存于 Mysql 中采用 Sqoop 来存入数仓中。
   2. 日志数据存于日志文件中，采用 Flume 来存入数仓中。
3. 业内经验：
   1. 大厂使用。
4. 技术成熟：
   1. 版本稳定。
5. 技术成熟度。
6. 开发维护成本。
7. 总成本预算。

* 数据采集传输： Flume,Kafka,Sqoop,Logstash,DataX.
* 数据存储：Mysql,HDFS,Hbase,Redis,MongoDB.
* 数据计算：Hive,Tez,Spark,Flink,Storm.
* 数据查询：Presto,Druid,Impala,Kyling.
* 数据可视化：Echarts,Superset,QuickBI,DataX.
* 任务调度：Azkaban,Oozie.
* 集群监控：Zabbix.
* 元数据管理：Atlas.
* 数据质量监控：Griffin,Shell,Python.




# 1. Hadoop 是什么

Hadoop 是 Apache 基金会开发的分布式系统基础架构。

解决了海量数据的存储和分析计算问题。

# 2. Hadoop 1.x 和 2.x 的区别

Hadoop 1.x 由 Common（辅助工具），HDFS （数据存储），MapReduce （计算+调度） 三部分组成。

Hadoop 2.x 将 MapReduce 的计算和调度分离，Yarn 单独负责调度任务，MapReduce 单独负责计算任务。

Hadoop 3.x 和 Hadoop 2.x 在结构上保持一致。

